name: Deploy installer to staging

on:
  push:
    paths:
      - "installer/**"
    branches:
      - "main"
permissions:
  id-token: write
  contents: read

jobs:
  build-and-deploy:
    uses: ./.github/workflows/deploy-runtime-installer.yml
    with:
      stage: "staging"
      version: 1
    secrets:
      ENCLAVES_PUBLIC_AWS_ROLE_PRODUCTION: ${{ secrets.ENCLAVES_PUBLIC_AWS_ROLE_PRODUCTION }}
      ENCLAVES_PUBLIC_AWS_ROLE_STAGING: ${{ secrets.ENCLAVES_PUBLIC_AWS_ROLE_STAGING }}
      aws-cloudfront-distribution-id: ${{ secrets.AWS_CLOUDFRONT_DISTRIBUTION_STAGING }}
